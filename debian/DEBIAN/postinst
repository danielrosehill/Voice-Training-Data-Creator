#!/bin/bash
set -e

# Create virtual environment for the application
INSTALL_DIR="/usr/lib/voice-training-data-creator"
VENV_DIR="$INSTALL_DIR/venv"

echo "Setting up Voice Training Data Creator..."

# Create virtual environment if it doesn't exist
if [ ! -d "$VENV_DIR" ]; then
    python3 -m venv "$VENV_DIR"
fi

# Install Python dependencies
"$VENV_DIR/bin/pip" install --upgrade pip
"$VENV_DIR/bin/pip" install -r "$INSTALL_DIR/requirements.txt"

# Update desktop database
if [ -x /usr/bin/update-desktop-database ]; then
    update-desktop-database -q
fi

# Update icon cache
if [ -x /usr/bin/gtk-update-icon-cache ]; then
    gtk-update-icon-cache -q -t -f /usr/share/icons/hicolor || true
fi

echo "Voice Training Data Creator installed successfully!"
echo "You can launch it from your application menu or run: voice-training-data-creator"

exit 0
